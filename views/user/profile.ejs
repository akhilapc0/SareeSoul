<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('./partials/head') %>
        <title>My Profile</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>

<body class="bg-light">
    <%- include('./partials/header') %>

        <div class="container mt-4 mb-5">
            <!-- User Name Header -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="text-center">
                        <h2 class="mb-0 text-dark">
                            <%= user.firstName %>
                                <%= user.lastName %>
                        </h2>
                    </div>
                </div>
            </div>

            <!-- Personal Information Section -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card shadow border-0">
                        <div class="card-header bg-primary text-white py-3">
                            <div class="d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">
                                    <i class="fas fa-user me-2"></i>Personal Information
                                </h5>
                                <a href="/profile/edit" class="btn btn-light btn-sm">
                                    <i class="fas fa-edit me-1"></i>Edit
                                </a>
                            </div>
                        </div>
                        <div class="card-body">
                            <!-- Profile Picture Row -->
                            <div class="row mb-3 align-items-center">
                                <div class="col-2">
                                    <div class="bg-primary text-white rounded-circle p-2 d-flex align-items-center justify-content-center"
                                        style="width: 40px; height: 40px;">
                                        <i class="fas fa-camera"></i>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <span class="fw-medium">Profile Picture:</span>
                                </div>
                                <div class="col-7">
                                    <% if (user.image && user.image.trim() !=="" ) { %>
                                        <!-- Case 1: User has uploaded an image -->
                                        <img src="<%= user.image %>" alt="Profile Image" class="rounded-circle border"
                                            width="50" height="50" style="object-fit: cover;">
                                        <% } else { %>
                                            <!-- Case 2: No image, show initials -->
                                            <% const initials=(user.firstName?.[0] || '' ) + (user.lastName?.[0] || ''
                                                ); %>
                                                <div class="rounded-circle border bg-secondary text-white d-flex justify-content-center align-items-center"
                                                    style="width:50px; height:50px; font-weight:bold; font-size:18px;">
                                                    <%= initials.toUpperCase() %>
                                                </div>
                                                <% } %>
                                </div>


                            </div>

                            <!-- Name Row -->
                            <div class="row mb-3 align-items-center">
                                <div class="col-2">
                                    <div class="bg-primary text-white rounded-circle p-2 d-flex align-items-center justify-content-center"
                                        style="width: 40px; height: 40px;">
                                        <i class="fas fa-user"></i>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <span class="fw-medium">Name:</span>
                                </div>
                                <div class="col-7">
                                    <span class="text-muted">
                                        <%= user.firstName %>
                                            <%= user.lastName %>
                                    </span>
                                </div>
                            </div>

                            <!-- Phone Row -->
                            <div class="row mb-0 align-items-center">
                                <div class="col-2">
                                    <div class="bg-primary text-white rounded-circle p-2 d-flex align-items-center justify-content-center"
                                        style="width: 40px; height: 40px;">
                                        <i class="fas fa-phone"></i>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <span class="fw-medium">Phone:</span>
                                </div>
                                <div class="col-7">
                                    <span class="text-muted">
                                        <%= user.phoneNumber || 'Not provided' %>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contact Information Section -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card shadow border-0">
                        <div class="card-header bg-success text-white py-3">
                            <div class="d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">
                                    <i class="fas fa-envelope me-2"></i>Contact Information
                                </h5>
                                <a href="/profile/change-email" class="btn btn-light btn-sm">
                                    <i class="fas fa-edit me-1"></i>Edit
                                </a>
                            </div>
                        </div>
                        <div class="card-body">
                            <!-- Email Row -->
                            <div class="row mb-0 align-items-center">
                                <div class="col-2">
                                    <div class="bg-success text-white rounded-circle p-2 d-flex align-items-center justify-content-center"
                                        style="width: 40px; height: 40px;">
                                        <i class="fas fa-envelope"></i>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <span class="fw-medium">Email:</span>
                                </div>
                                <div class="col-7">
                                    <span class="text-muted">
                                        <%= user.email %>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Password Section -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card shadow border-0">
                        <div class="card-header bg-success text-white py-3">
                            <div class="d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">
                                    <i class="fas fa-lock me-2"></i>Password
                                </h5>
                                <a href="/profile/change-password" class="btn btn-light btn-sm">
                                    <i class="fas fa-key me-1"></i>Change Password
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Referral Code Section -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card shadow border-0">
                        <div class="card-header bg-warning text-dark py-3">
                            <div class="d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">
                                    <i class="fas fa-gift me-2"></i>Your Referral Code
                                </h5>
                                <button id="copyReferralBtn" class="btn btn-light btn-sm">
                                    <i class="fas fa-copy me-1"></i>Copy
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="d-flex align-items-center">
                                <input type="text" id="referralCodeInput" class="form-control"
                                    value="<%= user.referralCode || 'Not available' %>" readonly>
                            </div>
                        </div>
                    </div>
                </div>
            </div>






        </div>

        <%- include('./partials/footer') %>

            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

            <script>
                const copyBtn = document.getElementById("copyReferralBtn");
                const input = document.getElementById("referralCodeInput");

                if (copyBtn) {
                    copyBtn.addEventListener("click", () => {
                        input.select();
                        document.execCommand("copy");
                        alert("Referral code copied!");
                    });
                }
            </script>

</body>

</html>